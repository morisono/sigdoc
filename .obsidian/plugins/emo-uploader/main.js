var Ct=Object.create;var X=Object.defineProperty;var _t=Object.getOwnPropertyDescriptor;var vt=Object.getOwnPropertyNames;var Ut=Object.getPrototypeOf,Rt=Object.prototype.hasOwnProperty;var Ue=l=>X(l,"__esModule",{value:!0});var It=(l,e)=>()=>(e||l((e={exports:{}}).exports,e),e.exports),kt=(l,e)=>{Ue(l);for(var t in e)X(l,t,{get:e[t],enumerable:!0})},Dt=(l,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of vt(e))!Rt.call(l,r)&&r!=="default"&&X(l,r,{get:()=>e[r],enumerable:!(t=_t(e,r))||t.enumerable});return l},P=l=>Dt(Ue(X(l!=null?Ct(Ut(l)):{},"default",l&&l.__esModule&&"default"in l?{get:()=>l.default,enumerable:!0}:{value:l,enumerable:!0})),l);var Tt=It((Do,Q)=>{(function(){"use strict";var l="input is invalid type",e=typeof window=="object",t=e?window:{};t.JS_SHA256_NO_WINDOW&&(e=!1);var r=!e&&typeof self=="object",s=!t.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;s?t=global:r&&(t=self);var a=!t.JS_SHA256_NO_COMMON_JS&&typeof Q=="object"&&Q.exports,n=typeof define=="function"&&define.amd,x=!t.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer!="undefined",i="0123456789abcdef".split(""),g=[-2147483648,8388608,32768,128],S=[24,16,8,0],H=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Y=["hex","array","digest","arrayBuffer"],q=[];(t.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(o){return Object.prototype.toString.call(o)==="[object Array]"}),x&&(t.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(o){return typeof o=="object"&&o.buffer&&o.buffer.constructor===ArrayBuffer});var qe=function(o,h){return function(c){return new C(h,!0).update(c)[o]()}},Ce=function(o){var h=qe("hex",o);s&&(h=qt(h,o)),h.create=function(){return new C(o)},h.update=function(f){return h.create().update(f)};for(var c=0;c<Y.length;++c){var p=Y[c];h[p]=qe(p,o)}return h},qt=function(o,h){var c=require("crypto"),p=require("buffer").Buffer,f=h?"sha224":"sha256",d;p.from&&!t.JS_SHA256_NO_BUFFER_FROM?d=p.from:d=function(m){return new p(m)};var b=function(m){if(typeof m=="string")return c.createHash(f).update(m,"utf8").digest("hex");if(m==null)throw new Error(l);return m.constructor===ArrayBuffer&&(m=new Uint8Array(m)),Array.isArray(m)||ArrayBuffer.isView(m)||m.constructor===p?c.createHash(f).update(d(m)).digest("hex"):o(m)};return b},_e=function(o,h){return function(c,p){return new K(c,h,!0).update(p)[o]()}},ve=function(o){var h=_e("hex",o);h.create=function(f){return new K(f,o)},h.update=function(f,d){return h.create(f).update(d)};for(var c=0;c<Y.length;++c){var p=Y[c];h[p]=_e(p,o)}return h};function C(o,h){h?(q[0]=q[16]=q[1]=q[2]=q[3]=q[4]=q[5]=q[6]=q[7]=q[8]=q[9]=q[10]=q[11]=q[12]=q[13]=q[14]=q[15]=0,this.blocks=q):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=o}C.prototype.update=function(o){if(!this.finalized){var h,c=typeof o;if(c!=="string"){if(c==="object"){if(o===null)throw new Error(l);if(x&&o.constructor===ArrayBuffer)o=new Uint8Array(o);else if(!Array.isArray(o)&&(!x||!ArrayBuffer.isView(o)))throw new Error(l)}else throw new Error(l);h=!0}for(var p,f=0,d,b=o.length,m=this.blocks;f<b;){if(this.hashed&&(this.hashed=!1,m[0]=this.block,m[16]=m[1]=m[2]=m[3]=m[4]=m[5]=m[6]=m[7]=m[8]=m[9]=m[10]=m[11]=m[12]=m[13]=m[14]=m[15]=0),h)for(d=this.start;f<b&&d<64;++f)m[d>>2]|=o[f]<<S[d++&3];else for(d=this.start;f<b&&d<64;++f)p=o.charCodeAt(f),p<128?m[d>>2]|=p<<S[d++&3]:p<2048?(m[d>>2]|=(192|p>>6)<<S[d++&3],m[d>>2]|=(128|p&63)<<S[d++&3]):p<55296||p>=57344?(m[d>>2]|=(224|p>>12)<<S[d++&3],m[d>>2]|=(128|p>>6&63)<<S[d++&3],m[d>>2]|=(128|p&63)<<S[d++&3]):(p=65536+((p&1023)<<10|o.charCodeAt(++f)&1023),m[d>>2]|=(240|p>>18)<<S[d++&3],m[d>>2]|=(128|p>>12&63)<<S[d++&3],m[d>>2]|=(128|p>>6&63)<<S[d++&3],m[d>>2]|=(128|p&63)<<S[d++&3]);this.lastByteIndex=d,this.bytes+=d-this.start,d>=64?(this.block=m[16],this.start=d-64,this.hash(),this.hashed=!0):this.start=d}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},C.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var o=this.blocks,h=this.lastByteIndex;o[16]=this.block,o[h>>2]|=g[h&3],this.block=o[16],h>=56&&(this.hashed||this.hash(),o[0]=this.block,o[16]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=0),o[14]=this.hBytes<<3|this.bytes>>>29,o[15]=this.bytes<<3,this.hash()}},C.prototype.hash=function(){var o=this.h0,h=this.h1,c=this.h2,p=this.h3,f=this.h4,d=this.h5,b=this.h6,m=this.h7,y=this.blocks,E,U,R,O,F,N,L,j,ee,te,W;for(E=16;E<64;++E)F=y[E-15],U=(F>>>7|F<<25)^(F>>>18|F<<14)^F>>>3,F=y[E-2],R=(F>>>17|F<<15)^(F>>>19|F<<13)^F>>>10,y[E]=y[E-16]+U+y[E-7]+R<<0;for(W=h&c,E=0;E<64;E+=4)this.first?(this.is224?(j=300032,F=y[0]-1413257819,m=F-150054599<<0,p=F+24177077<<0):(j=704751109,F=y[0]-210244248,m=F-1521486534<<0,p=F+143694565<<0),this.first=!1):(U=(o>>>2|o<<30)^(o>>>13|o<<19)^(o>>>22|o<<10),R=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7),j=o&h,O=j^o&c^W,L=f&d^~f&b,F=m+R+L+H[E]+y[E],N=U+O,m=p+F<<0,p=F+N<<0),U=(p>>>2|p<<30)^(p>>>13|p<<19)^(p>>>22|p<<10),R=(m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7),ee=p&o,O=ee^p&h^j,L=m&f^~m&d,F=b+R+L+H[E+1]+y[E+1],N=U+O,b=c+F<<0,c=F+N<<0,U=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),R=(b>>>6|b<<26)^(b>>>11|b<<21)^(b>>>25|b<<7),te=c&p,O=te^c&o^ee,L=b&m^~b&f,F=d+R+L+H[E+2]+y[E+2],N=U+O,d=h+F<<0,h=F+N<<0,U=(h>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),R=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7),W=h&c,O=W^h&p^te,L=d&b^~d&m,F=f+R+L+H[E+3]+y[E+3],N=U+O,f=o+F<<0,o=F+N<<0,this.chromeBugWorkAround=!0;this.h0=this.h0+o<<0,this.h1=this.h1+h<<0,this.h2=this.h2+c<<0,this.h3=this.h3+p<<0,this.h4=this.h4+f<<0,this.h5=this.h5+d<<0,this.h6=this.h6+b<<0,this.h7=this.h7+m<<0},C.prototype.hex=function(){this.finalize();var o=this.h0,h=this.h1,c=this.h2,p=this.h3,f=this.h4,d=this.h5,b=this.h6,m=this.h7,y=i[o>>28&15]+i[o>>24&15]+i[o>>20&15]+i[o>>16&15]+i[o>>12&15]+i[o>>8&15]+i[o>>4&15]+i[o&15]+i[h>>28&15]+i[h>>24&15]+i[h>>20&15]+i[h>>16&15]+i[h>>12&15]+i[h>>8&15]+i[h>>4&15]+i[h&15]+i[c>>28&15]+i[c>>24&15]+i[c>>20&15]+i[c>>16&15]+i[c>>12&15]+i[c>>8&15]+i[c>>4&15]+i[c&15]+i[p>>28&15]+i[p>>24&15]+i[p>>20&15]+i[p>>16&15]+i[p>>12&15]+i[p>>8&15]+i[p>>4&15]+i[p&15]+i[f>>28&15]+i[f>>24&15]+i[f>>20&15]+i[f>>16&15]+i[f>>12&15]+i[f>>8&15]+i[f>>4&15]+i[f&15]+i[d>>28&15]+i[d>>24&15]+i[d>>20&15]+i[d>>16&15]+i[d>>12&15]+i[d>>8&15]+i[d>>4&15]+i[d&15]+i[b>>28&15]+i[b>>24&15]+i[b>>20&15]+i[b>>16&15]+i[b>>12&15]+i[b>>8&15]+i[b>>4&15]+i[b&15];return this.is224||(y+=i[m>>28&15]+i[m>>24&15]+i[m>>20&15]+i[m>>16&15]+i[m>>12&15]+i[m>>8&15]+i[m>>4&15]+i[m&15]),y},C.prototype.toString=C.prototype.hex,C.prototype.digest=function(){this.finalize();var o=this.h0,h=this.h1,c=this.h2,p=this.h3,f=this.h4,d=this.h5,b=this.h6,m=this.h7,y=[o>>24&255,o>>16&255,o>>8&255,o&255,h>>24&255,h>>16&255,h>>8&255,h&255,c>>24&255,c>>16&255,c>>8&255,c&255,p>>24&255,p>>16&255,p>>8&255,p&255,f>>24&255,f>>16&255,f>>8&255,f&255,d>>24&255,d>>16&255,d>>8&255,d&255,b>>24&255,b>>16&255,b>>8&255,b&255];return this.is224||y.push(m>>24&255,m>>16&255,m>>8&255,m&255),y},C.prototype.array=C.prototype.digest,C.prototype.arrayBuffer=function(){this.finalize();var o=new ArrayBuffer(this.is224?28:32),h=new DataView(o);return h.setUint32(0,this.h0),h.setUint32(4,this.h1),h.setUint32(8,this.h2),h.setUint32(12,this.h3),h.setUint32(16,this.h4),h.setUint32(20,this.h5),h.setUint32(24,this.h6),this.is224||h.setUint32(28,this.h7),o};function K(o,h,c){var p,f=typeof o;if(f==="string"){var d=[],b=o.length,m=0,y;for(p=0;p<b;++p)y=o.charCodeAt(p),y<128?d[m++]=y:y<2048?(d[m++]=192|y>>6,d[m++]=128|y&63):y<55296||y>=57344?(d[m++]=224|y>>12,d[m++]=128|y>>6&63,d[m++]=128|y&63):(y=65536+((y&1023)<<10|o.charCodeAt(++p)&1023),d[m++]=240|y>>18,d[m++]=128|y>>12&63,d[m++]=128|y>>6&63,d[m++]=128|y&63);o=d}else if(f==="object"){if(o===null)throw new Error(l);if(x&&o.constructor===ArrayBuffer)o=new Uint8Array(o);else if(!Array.isArray(o)&&(!x||!ArrayBuffer.isView(o)))throw new Error(l)}else throw new Error(l);o.length>64&&(o=new C(h,!0).update(o).array());var E=[],U=[];for(p=0;p<64;++p){var R=o[p]||0;E[p]=92^R,U[p]=54^R}C.call(this,h,c),this.update(U),this.oKeyPad=E,this.inner=!0,this.sharedMemory=c}K.prototype=new C,K.prototype.finalize=function(){if(C.prototype.finalize.call(this),this.inner){this.inner=!1;var o=this.array();C.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(o),C.prototype.finalize.call(this)}};var D=Ce();D.sha256=D,D.sha224=Ce(!0),D.sha256.hmac=ve(),D.sha224.hmac=ve(!0),a?Q.exports=D:(t.sha256=D.sha256,t.sha224=D.sha224,n&&define(function(){return D}))})()});kt(exports,{default:()=>Ae});var J=P(require("obsidian"));var et=P(require("obsidian"));var Re={};var Ie={};var ke={};var De={};var re={domain:"dmain","no sign in":"Imgur no sign in!","not required":"not required",broken:"Emo broken. Check your target","upload error":" upload error","parms error":"Emo need more prams","target hosting":"target hosting","target hosting desc":"Choose your target. Before uploading, make sure you have completely filled in the necessary parameters of the selected platform.","Cloudinary Settings":"Cloudinary Settings","Upload Folder desc":"Folder name to use in Cloudinary. Note, this will be ignored if you have a folder set in your Cloudinary Upload Preset. Not required.","Github Settings":"Github Settings",owner:"owner",repo:"repo",branch:"branch",token:"token",message:"message",path:"path",cdn:"CDN","random filename":"random filename","random filename desc":"Random file names will greatly avoid duplicate file names. If you are sure that you need to use the original file name during this upload, make sure that no duplicate naming will occur under the path you choose.","imgbb Settings":"imgbb Settings",tips:"Tips","tips text":"Imgur anonymous upload will produce the link in this format: ![deletehash](url). [deletehash] is used to delete the image you just uploaded. If your note will be used for publicity, please remember to delete it in time. Authentication upload can be deleted on Imgur.","Imgur Settings":"Imgur Settings","Anonymous Upload":"Anonymous Upload","Anonymous Upload desc":"Files uploaded anonymously will not show in your Imgur account.",imgurid:"ID","built-in id desc":"The built-in ID has a daily usage limit, if it is temporarily invalid, you can use your own client ID here to upload and delete. Not required.",delete:"delete","delete desc":"If you want to delete the image on Imgur, delete it here with the deletehash.","delete btn":"Delete","delete done":"delete done","delete fail":"delete fail",authenticate:"authenticate","auth desc":"Re-auth is required for the change ID to take effect.","imgur account":"Authenticated as: ","auth error":"Authentication failed with error: ","sign in":"sign in","Sign Out":"Sign Out","ImgURL Settings":"ImgURL Settings","SM.MS Settings":"SM.MS Settings","Catbox Settings":"Catbox Settings","Chevereto Settings":"Chevereto Settings","AList Settings":"Alist Settings",username:"username",password:"password",uploadPath:"uploadPath"};var Me={};var Oe={};var Ne={};var Le={};var Be={};var $e={};var He={};var Ge={};var je={};var Ve={};var ze={};var Je={};var Ye={};var Ke={};var We={};var Xe={};var Ze={domain:"\u57DF\u540D","no sign in":"Imgur\u672A\u767B\u5F55\uFF01","not required":"\u53EF\u4E0D\u586B",broken:"Emo\u5DE5\u4F5C\u5F02\u5E38\uFF0C\u68C0\u89C6\u4F60\u7684\u76EE\u6807\u5E73\u53F0\u9009\u62E9","upload error":"\u4E0A\u4F20\u5931\u8D25","parms error":"\u5F53\u524D\u5E73\u53F0\u6240\u9700\u5FC5\u8981\u53C2\u6570\u672A\u586B\u5199\u5B8C\u5168","target hosting":"\u6258\u7BA1\u5E73\u53F0","target hosting desc":"\u9009\u62E9\u76EE\u6807\u3002\u4E0A\u4F20\u4E4B\u524D\uFF0C\u8BF7\u786E\u4FDD\u6240\u9009\u5E73\u53F0\u7684\u5FC5\u8981\u53C2\u6570\u5DF2\u586B\u5199\u5B8C\u6210\u3002","Cloudinary Settings":"Cloudinary\u914D\u7F6E","Upload Folder desc":"\u8981\u5728Cloudinary\u4E2D\u4F7F\u7528\u7684\u6587\u4EF6\u5939\u540D\u79F0\u3002\u6CE8\u610F\uFF0C\u5982\u679C\u5728Cloudinary\u9884\u8BBE\u4E86\u6587\u4EF6\u5939\uFF0C\u5219\u4F1A\u5FFD\u7565\u6B64\u9879\u3002\u53EF\u4E0D\u586B\u3002","Github Settings":"Github\u914D\u7F6E",owner:"\u7528\u6237\u540D",repo:"\u4ED3\u5E93",branch:"\u5206\u652F",token:"\u4EE4\u724C",message:"\u63D0\u4EA4\u4FE1\u606F",path:"\u8DEF\u5F84",cdn:"CDN","random filename":"\u968F\u673A\u6587\u4EF6\u540D","random filename desc":"\u91C7\u7528\u968F\u673A\u6587\u4EF6\u540D\u5C06\u6781\u5927\u907F\u514D\u91CD\u540D\u3002\u5982\u679C\u786E\u5B9A\u5728\u4E0A\u4F20\u8FC7\u7A0B\u4E2D\u9700\u8981\u4F7F\u7528\u539F\u6587\u4EF6\u540D\uFF0C\u8BF7\u786E\u4FDD\u6240\u9009\u8DEF\u5F84\u4E0B\u4E0D\u4F1A\u51FA\u73B0\u91CD\u540D\u95EE\u9898\u3002","imgbb Settings":"imgbb\u914D\u7F6E",tips:"\u8D34\u58EB","tips text":"Imgur\u533F\u540D\u4E0A\u4F20\u5C06\u751F\u6210\u4EE5\u4E0B\u683C\u5F0F\u7684\u94FE\u63A5\uFF1A![deletehash](url)\u3002[deletehash]\u7528\u4E8E\u5220\u9664\u521A\u521A\u4E0A\u4F20\u7684\u56FE\u50CF\u3002\u5982\u679C\u60A8\u7684\u7B14\u8BB0\u4F1A\u88AB\u516C\u5F00\uFF0C\u8BF7\u53CA\u65F6\u5728\u7B14\u8BB0\u4E2D\u5220\u9664deletehash\u3002\u8BA4\u8BC1\u4E0A\u4F20\u53EF\u5728Imgur\u4E0A\u5220\u9664\u3002","Imgur Settings":"Imgur\u914D\u7F6E","Anonymous Upload":"\u533F\u540D\u4E0A\u4F20","Anonymous Upload desc":"\u533F\u540D\u4E0A\u4F20\u7684\u6587\u4EF6\u4E0D\u4F1A\u663E\u793A\u5728Imgur\u5E10\u6237\u4E2D\u3002",imgurid:"\u5BA2\u6237\u7AEFID","built-in id desc":"\u5185\u7F6EID\u6709\u6BCF\u65E5\u4F7F\u7528\u9650\u5236\uFF0C\u5982\u679C\u6682\u65F6\u5931\u6548\uFF0C\u53EF\u4EE5\u4F7F\u7528\u81EA\u5DF1\u7684\u5BA2\u6237\u7AEFID\u4EE5\u8FDB\u884C\u4E0A\u4F20\u548C\u5220\u9664\u3002\u53EF\u4E0D\u586B\u3002",delete:"\u5220\u9664","delete desc":"\u5982\u679C\u9700\u8981\u5220\u9664Imgur\u4E0A\u7684\u56FE\u50CF\uFF0C\u8BF7\u5728\u6B64\u5904\u4F7F\u7528deletehash\u5C06\u5176\u5220\u9664\u3002","delete btn":"\u5220\u9664","delete done":"\u5220\u9664\u6210\u529F","delete fail":"\u5220\u9664\u5931\u8D25",authenticate:"\u8BA4\u8BC1","auth desc":"\u66F4\u6539ID\u9700\u8981\u91CD\u65B0\u8BA4\u8BC1\u624D\u80FD\u751F\u6548\u3002","imgur account":"\u5F53\u524D\u7528\u6237\uFF1A ","auth error":"\u8BA4\u8BC1\u9519\u8BEF: ","sign in":"\u767B\u5F55","Sign Out":"\u6CE8\u9500","ImgURL Settings":"ImgURL\u914D\u7F6E","SM.MS Settings":"SM.MS\u914D\u7F6E","Catbox Settings":"Catbox\u914D\u7F6E","Chevereto Settings":"Chevereto\u914D\u7F6E","AList Settings":"Alist\u914D\u7F6E",username:"\u7528\u6237\u540D",password:"\u5BC6\u7801",uploadPath:"\u4E0A\u4F20\u8DEF\u5F84"};var Qe={domain:"\u57DF\u540D","no sign in":"Imgur\u672A\u767B\u9304\uFF01","not required":"\u53EF\u4E0D\u586B",broken:"Emo\u5DE5\u4F5C\u7570\u5E38\uFF0C\u6AA2\u8996\u4F60\u7684\u76EE\u6A19\u5E73\u53F0\u9078\u64C7","upload error":"\u4E0A\u50B3\u5931\u6557","parms error":"\u76EE\u524D\u5E73\u53F0\u6240\u9700\u5FC5\u8981\u53C3\u6578\u672A\u586B\u5BEB\u5B8C\u5168","target hosting":"\u8A17\u7BA1\u5E73\u53F0","target hosting desc":"\u9078\u64C7\u76EE\u6A19\u3002\u4E0A\u50B3\u4E4B\u524D\uFF0C\u8ACB\u78BA\u4FDD\u6240\u9078\u5E73\u53F0\u7684\u5FC5\u8981\u53C3\u6578\u5DF2\u586B\u5BEB\u5B8C\u6210\u3002","Cloudinary Settings":"Cloudinary\u914D\u7F6E","Upload Folder desc":"\u8981\u5728Cloudinary\u4E2D\u4F7F\u7528\u7684\u8CC7\u6599\u593E\u540D\u7A31\u3002\u6CE8\u610F\uFF0C\u5982\u679C\u5728Cloudinary\u9810\u8A2D\u4E86\u8CC7\u6599\u593E\uFF0C\u5247\u6703\u5FFD\u7565\u6B64\u9805\u3002\u53EF\u4E0D\u586B\u3002","Github Settings":"Github\u914D\u7F6E",owner:"\u4F7F\u7528\u8005\u540D\u7A31",repo:"\u5132\u5B58\u5EAB",branch:"\u5206\u652F",token:"\u4EE4\u724C",message:"\u63D0\u4EA4\u8CC7\u8A0A",path:"\u8DEF\u5F91",cdn:"CDN","random filename":"\u96A8\u6A5F\u6A94\u540D","random filename desc":"\u63A1\u7528\u96A8\u6A5F\u6A94\u540D\u5C07\u6975\u5927\u907F\u514D\u91CD\u540D\u3002\u5982\u679C\u78BA\u5B9A\u5728\u4E0A\u50B3\u904E\u7A0B\u4E2D\u9700\u8981\u4F7F\u7528\u539F\u6A94\u540D\uFF0C\u8ACB\u78BA\u4FDD\u6240\u9078\u8DEF\u5F91\u4E0B\u4E0D\u6703\u51FA\u73FE\u91CD\u540D\u554F\u984C\u3002","imgbb Settings":"imgbb\u914D\u7F6E",tips:"\u5C0F\u6280\u5DE7","tips text":"Imgur\u533F\u540D\u4E0A\u50B3\u5C07\u7522\u751F\u4EE5\u4E0B\u683C\u5F0F\u7684\u93C8\u63A5\uFF1A![deletehash](url)\u3002[deletehash]\u7528\u65BC\u522A\u9664\u525B\u525B\u4E0A\u50B3\u7684\u5F71\u50CF\u3002\u5982\u679C\u60A8\u7684\u7B46\u8A18\u6703\u88AB\u516C\u958B\uFF0C\u8ACB\u53CA\u6642\u5728\u7B46\u8A18\u4E2D\u522A\u9664deletehash\u3002\u8A8D\u8B49\u4E0A\u50B3\u53EF\u5728Imgur\u4E0A\u522A\u9664\u3002","Imgur Settings":"Imgur\u914D\u7F6E","Anonymous Upload":"\u533F\u540D\u4E0A\u50B3","Anonymous Upload desc":"\u533F\u540D\u4E0A\u50B3\u7684\u6A94\u6848\u4E0D\u6703\u986F\u793A\u5728Imgur\u5E33\u6236\u4E2D\u3002",imgurid:"\u5BA2\u6236\u7AEFID","built-in id desc":"\u5167\u5EFAID\u6709\u6BCF\u65E5\u4F7F\u7528\u9650\u5236\uFF0C\u5982\u679C\u66AB\u6642\u5931\u6548\uFF0C\u53EF\u4EE5\u4F7F\u7528\u81EA\u5DF1\u7684\u5BA2\u6236\u7AEFID\u4EE5\u9032\u884C\u4E0A\u50B3\u548C\u522A\u9664\u3002\u53EF\u4E0D\u586B\u3002",delete:"\u522A\u9664","delete desc":"\u5982\u679C\u9700\u8981\u522A\u9664Imgur\u4E0A\u7684\u5F71\u50CF\uFF0C\u8ACB\u5728\u6B64\u8655\u4F7F\u7528deletehash\u5C07\u5176\u522A\u9664\u3002","delete btn":"\u522A\u9664","delete done":"\u522A\u9664\u6210\u529F","delete fail":"\u522A\u9664\u5931\u6557",authenticate:"\u8A8D\u8B49","auth desc":"\u66F4\u6539ID\u9700\u8981\u91CD\u65B0\u8A8D\u8B49\u624D\u80FD\u751F\u6548\u3002","imgur account":"\u76EE\u524D\u4F7F\u7528\u8005\uFF1A ","auth error":"\u8A8D\u8B49\u932F\u8AA4: ","sign in":"\u767B\u9304","Sign Out":"\u8A3B\u92B7","ImgURL Settings":"ImgURL\u914D\u7F6E","SM.MS Settings":"SM.MS\u914D\u7F6E","Catbox Settings":"Catbox\u914D\u7F6E","Chevereto Settings":"Chevereto\u914D\u7F6E","AList Settings":"Alist\u914D\u7F6E",username:"\u7528\u6236\u540D",password:"\u5BC6\u78BC",uploadPath:"\u4E0A\u50B3\u8DEF\u5F91"};var Mt={ar:Re,cs:Ie,da:ke,de:De,en:re,"en-gb":Me,es:Oe,fr:Ne,hi:Le,id:Be,it:$e,ja:He,ko:Ge,nl:je,nn:Ve,pl:ze,pt:Je,"pt-br":Ye,ro:Ke,ru:We,tr:Xe,"zh-cn":Ze,"zh-tw":Qe},ae=Mt[et.moment.locale()];function u(l){var e;return(e=ae==null?void 0:ae[l])!=null?e:re[l]}var G=P(require("obsidian"));var tt={required:{userhash:""}};var rt={required:{domain:"",token:""}};var at={required:{name:"",present:""},folder:""};var I;(function(r){r.jsdelivr="jsdelivr",r.statically="statically",r.raw="raw"})(I||(I={}));var ot={required:{owner:"",repo:"",branch:"main",token:"",message:"from emo-uploader\xB7Github"},path:"",random:!0,cdn:I.raw};var st={required:{key:""}};var it={required:{emoid:"4547d4aee97ce8f"},clientid:"",anonymous:!0};var nt={required:{uid:"",token:""}};var mt={required:{token:""}};var dt={required:{domain:"",username:"",password:"",uploadPath:""}};var w;(function(g){g.Github="Github",g.Cloudinary="Cloudinary",g.Catbox="Catbox",g.Imgur="Imgur",g.Smms="SM.MS",g.ImgURL="ImgURL",g.Imgbb="imgbb",g.Chevereto="chevereto",g.Alist="AList"})(w||(w={}));var pt={choice:w.Github,github_parms:ot,imgur_parms:it,cloudinary_parms:at,smms_parms:mt,imgurl_parms:nt,imgbb_parms:st,catbox_parms:tt,chevereto_parms:rt,alist_parms:dt};var Z=P(require("obsidian"));var T=class{constructor(e,t,r){this.kind=e,this.element=t.createDiv(e),this.display(this.element,r),this.element.hide()}update(e){this.kind===e?this.element.show():this.element.hide()}};var oe=class extends T{constructor(e,t){super(w.Cloudinary,e,t)}display(e,t){let r=t.config.cloudinary_parms;e.createEl("h3",{text:u("Cloudinary Settings")}),new Z.Setting(e).setName("Cloud Name").addText(s=>{s.setValue(r.required.name).onChange(async a=>{r.required.name=a,await t.saveSettings()})}),new Z.Setting(e).setName("Upload Presets").addText(s=>{s.setValue(r.required.present).onChange(async a=>{r.required.present=a,await t.saveSettings()})}),new Z.Setting(e).setName("Upload Folder").setDesc(u("Upload Folder desc")).addText(s=>{s.setPlaceholder("obsidian -> obsidian/pic.png").setValue(r.folder).onChange(async a=>{r.folder=a,await t.saveSettings()})})}};var M=P(require("obsidian"));var se=class extends T{constructor(e,t){super(w.Github,e,t)}display(e,t){let r=t.config.github_parms;e.createEl("h3",{text:u("Github Settings")}),new M.Setting(e).setName(u("owner")).addText(a=>{a.setValue(r.required.owner).onChange(async n=>{r.required.owner=n,await t.saveSettings()})}),new M.Setting(e).setName(u("repo")).addText(a=>{a.setValue(r.required.repo).onChange(async n=>{r.required.repo=n,await t.saveSettings()})}),new M.Setting(e).setName(u("branch")).addText(a=>{a.setValue(r.required.branch).onChange(async n=>{r.required.branch=n,await t.saveSettings()})}),new M.Setting(e).setName(u("token")).addText(a=>{a.setValue(r.required.token).onChange(async n=>{r.required.token=n,await t.saveSettings()})}),new M.Setting(e).setName(u("message")).addText(a=>{a.setValue(r.required.message).onChange(async n=>{r.required.message=n,await t.saveSettings()})}),new M.Setting(e).setName(u("path")).setDesc(u("not required")).addText(a=>{a.setPlaceholder("obsidian/ -> obsidian/pic.png").setValue(r.path).onChange(async n=>{r.path=n,await t.saveSettings()})}),new M.Setting(e).setName(u("random filename")).setDesc(u("random filename desc")).addToggle(a=>{a.setValue(r.random),a.onChange(async n=>{r.random=n,await t.saveSettings()})});let s=[];for(let a in I)s.push(I[a]);new M.Setting(e).setName(u("cdn")).addDropdown(a=>{s.forEach(n=>{a.addOption(n,n)}),a.setValue(r.cdn).onChange(async n=>{r.cdn=n,await t.saveSettings()})})}};var ht=P(require("obsidian"));var ie=class extends T{constructor(e,t){super(w.Imgbb,e,t)}display(e,t){let r=t.config.imgbb_parms;e.createEl("h3",{text:u("imgbb Settings")}),new ht.Setting(e).setName("key").addText(s=>{s.setValue(r.required.key).onChange(async a=>{r.required.key=a,await t.saveSettings()})})}};var ne=P(require("obsidian"));var me=class extends T{constructor(e,t){super(w.ImgURL,e,t)}display(e,t){let r=t.config.imgurl_parms;e.createEl("h3",{text:u("ImgURL Settings")}),new ne.Setting(e).setName("uid").addText(s=>{s.setValue(r.required.uid).onChange(async a=>{r.required.uid=a,await t.saveSettings()})}),new ne.Setting(e).setName("token").addText(s=>{s.setValue(r.required.token).onChange(async a=>{r.required.token=a,await t.saveSettings()})})}};var ut=P(require("obsidian"));var de=class extends T{constructor(e,t){super(w.Smms,e,t)}display(e,t){let r=t.config.smms_parms;e.createEl("h3",{text:u("SM.MS Settings")}),new ut.Setting(e).setName("token").addText(s=>{s.setValue(r.required.token).onChange(async a=>{r.required.token=a,await t.saveSettings()})})}};var k=P(require("obsidian"));var $="imgur-access_token",V="4547d4aee97ce8f",pe="loveaimeainixucheng",_="multipart/form-data;boundary="+pe;var he=class extends T{constructor(e,t){super(w.Imgur,e,t);this.imgurStateText=u("authenticate");this.imgurBtnText=u("sign in");this.authenticated=!1}async display(e,t){let r=t.config.imgur_parms;e.createEl("h3",{text:u("tips")}),e.createDiv().setText(u("tips text")),e.createEl("h3",{text:u("Imgur Settings")}),new k.Setting(e).setName(u("Anonymous Upload")).setDesc(u("Anonymous Upload desc")).addToggle(a=>{a.setValue(r.anonymous),a.onChange(async n=>{r.anonymous=n,await t.saveSettings()})}),new k.Setting(e).setName(u("imgurid")).setDesc(u("built-in id desc")).addText(a=>{a.setValue(r.clientid).onChange(async n=>{r.clientid=n,await t.saveSettings()})});let s="";new k.Setting(e).setName(u("delete")).setDesc(u("delete desc")).addText(a=>{a.setPlaceholder("deletehash").onChange(async n=>{s=n})}).addButton(a=>{a.setCta().setButtonText(u("delete btn")).onClick(()=>{let n="Client-ID ";r.clientid!==""?n+=r.clientid:n+=V;let x={url:"https://api.imgur.com/3/image/"+s,method:"DELETE",headers:{Authorization:n}};(0,k.request)(x).then(()=>{console.log(new k.Notice(u("delete done"),2e3))}).catch(()=>{console.log(new k.Notice(u("delete fail"),2e3))})})}),await this.checkState(),this.loginState=new k.Setting(e),this.loginState.setName(this.imgurStateText).setDesc(u("auth desc")).addButton(a=>{this.loginBtn=a,this.loginBtn.setCta().setButtonText(this.imgurBtnText).onClick(async()=>{if(this.authenticated)localStorage.removeItem($),this.authenticated=this.drawLogin();else{let n="";r.clientid!==""?n+=r.clientid:n+=V,window.open(`https://api.imgur.com/oauth2/authorize?client_id=${n}&response_type=token`)}})})}async checkState(){try{let e=await this.getAccountName();e!==u("no sign in")&&(this.imgurStateText=u("imgur account")+`${e} \u2705`,this.imgurBtnText=u("Sign Out"),this.authenticated=!0)}catch(e){console.log(e)}}async getAccountName(){let e=localStorage.getItem($);if(e===null)return u("no sign in");let t=await fetch("https://api.imgur.com/3/account/me",{headers:new Headers({Authorization:`Bearer ${e}`})});if(!t.ok)throw new Error("Imgur account error");return(await t.json()).data.url}drawLogin(){return this.imgurStateText=u("authenticate"),this.imgurBtnText=u("sign in"),this.loginState.setName(this.imgurStateText),this.loginBtn.setButtonText(this.imgurBtnText),!1}};var lt=P(require("obsidian"));var ue=class extends T{constructor(e,t){super(w.Catbox,e,t)}display(e,t){let r=t.config.catbox_parms;e.createEl("h3",{text:u("Catbox Settings")}),new lt.Setting(e).setName("userhash").addText(s=>{s.setValue(r.required.userhash).onChange(async a=>{r.required.userhash=a,await t.saveSettings()})})}};var le=P(require("obsidian"));var ce=class extends T{constructor(e,t){super(w.Chevereto,e,t)}display(e,t){let r=t.config.chevereto_parms;e.createEl("h3",{text:u("Chevereto Settings")}),new le.Setting(e).setName(u("domain")).addText(s=>{s.setValue(r.required.domain).onChange(async a=>{r.required.domain=a,await t.saveSettings()})}),new le.Setting(e).setName("token").addText(s=>{s.setValue(r.required.token).onChange(async a=>{r.required.token=a,await t.saveSettings()})})}};var z=P(require("obsidian"));var fe=class extends T{constructor(e,t){super(w.Alist,e,t)}display(e,t){let r=t.config.alist_parms;e.createEl("h3",{text:u("AList Settings")}),new z.Setting(e).setName(u("domain")).addText(s=>{s.setPlaceholder("https://alist.example.com").setValue(r.required.domain).onChange(async a=>{r.required.domain=a,await t.saveSettings()})}),new z.Setting(e).setName(u("username")).addText(s=>{s.setValue(r.required.username).onChange(async a=>{r.required.username=a,await t.saveSettings()})}),new z.Setting(e).setName(u("password")).addText(s=>{s.setValue(r.required.password).onChange(async a=>{r.required.password=a,await t.saveSettings()})}),new z.Setting(e).setName(u("uploadPath")).addText(s=>{s.setValue(r.required.uploadPath).onChange(async a=>{r.required.uploadPath=a,await t.saveSettings()})})}};var ge=class extends G.PluginSettingTab{constructor(e,t){super(e,t);this.plugin=t,this.setUpHandler()}display(){let{containerEl:e}=this;e.empty();let t=e.createDiv("cola");t.addClass("emo-cola-div");let s=t.createEl("a",{href:"https://lestua.eu.org/donate"}).createEl("img");s.outerHTML='<?xml version="1.0" encoding="UTF-8"?><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><line x1="10" y1="16" x2="38" y2="16" stroke="currentcolor" stroke-width="4" stroke-linecap="round"/><path d="M14.153 18.1425C14.0703 16.9848 14.9873 16 16.148 16H31.852C33.0127 16 33.9297 16.9848 33.847 18.1425L32.1327 42.1425C32.0579 43.1891 31.187 44 30.1378 44H17.8622C16.813 44 15.9421 43.1891 15.8673 42.1425L14.153 18.1425Z" stroke="currentcolor" stroke-width="4"/><path d="M24 10V6C24 4.89543 24.8954 4 26 4H29" stroke="currentcolor" stroke-width="4" stroke-linecap="round"/><path d="M14.7215 11.6712C14.8822 10.7068 15.7166 10 16.6943 10H31.3057C32.2834 10 33.1178 10.7068 33.2785 11.6712L34 16H14L14.7215 11.6712Z" fill="none" stroke="currentcolor" stroke-width="4"/></svg>',e.createEl("h2",{text:"Emo"});let a=new G.Setting(e).setName(u("target hosting")).setDesc(u("target hosting desc")),n=[];n.push(new se(e,this.plugin)),n.push(new he(e,this.plugin)),n.push(new oe(e,this.plugin)),n.push(new de(e,this.plugin)),n.push(new me(e,this.plugin)),n.push(new ie(e,this.plugin)),n.push(new ue(e,this.plugin)),n.push(new ce(e,this.plugin)),n.push(new fe(e,this.plugin)),n.forEach(i=>{i.update(this.plugin.config.choice)});let x=[];for(let i in w)x.push(w[i]);a.addDropdown(i=>{x.forEach(g=>{i.addOption(g,g)}),i.setValue(this.plugin.config.choice).onChange(async g=>{this.plugin.config.choice=g,await this.plugin.saveSettings(),n.forEach(S=>{S.update(this.plugin.config.choice)})})})}setUpHandler(){this.plugin.registerObsidianProtocolHandler("emo-imgur-oauth",async e=>{if(e.error!==void 0){console.log(new G.Notice(u("auth error")+`${e.error}`));return}let t=e.hash.split("&").map(s=>{let a=s.split("=");return[a[0],a[1]]}),r=new Map(t);localStorage.setItem($,r.get("access_token")),this.display()})}};var xt=P(require("obsidian"));async function ct(l){return await new Promise((e,t)=>{let r=new FileReader,s;r.readAsArrayBuffer(l),r.onload=()=>{s=r.result},r.onerror=a=>{t(a)},r.onloadend=()=>{e(s)}})}async function ft(l){return await new Promise((e,t)=>{let r=new FileReader,s;r.readAsDataURL(l),r.onload=()=>{s=r.result,s=s.slice(s.indexOf(",")+1)},r.onerror=a=>{t(a)},r.onloadend=()=>{e(s)}})}function gt(){return Date.parse(new Date().toString()).toString()+(Math.random()*10086).toString(36).slice(-6)}var A=class{isValid(){let e=!0;for(let t in this.parms.required)if(e&&(e=Ot(this.parms.required[t])),!e)return!1;return!0}};function Ot(l){return l.length>0}var xe=class extends A{constructor(e){super();this.parms=e}async upload(e){let t="";if(this.parms.random){let n=e.name.lastIndexOf(".");t=this.parms.path+gt(),t+=n>0?e.name.substring(n):""}else t=this.parms.path+e.name;let r={owner:this.parms.required.owner,repo:this.parms.required.repo,branch:this.parms.required.branch,path:t,message:this.parms.required.message,content:await ft(e)},s=JSON.stringify(r),a={url:`https://api.github.com/repos/${this.parms.required.owner}/${this.parms.required.repo}/contents/${t}`,method:"PUT",headers:{Authorization:`token ${this.parms.required.token}`},body:s};return await new Promise((n,x)=>{(0,xt.request)(a).then(()=>{let i;switch(console.log(this.parms.cdn),this.parms.cdn){case I.jsdelivr:i=`![gh](https://cdn.jsdelivr.net/gh/${this.parms.required.owner}/${this.parms.required.repo}@${this.parms.required.branch}/${t})`;break;case I.statically:i=`![gh](https://cdn.statically.io/gh/${this.parms.required.owner}/${this.parms.required.repo}/${this.parms.required.branch}/${t})`;break;case I.raw:i=`![gh](https://raw.githubusercontent.com/${this.parms.required.owner}/${this.parms.required.repo}/${this.parms.required.branch}/${t})`;break;default:i=`![gh](https://raw.githubusercontent.com/${this.parms.required.owner}/${this.parms.required.repo}/${this.parms.required.branch}/${t})`;break}n(i)}).catch(i=>{x(i)})})}};var bt=P(require("obsidian"));var v=class{constructor(){this.randomBoundary=pe;this.body=[],this.boundary="--"+this.randomBoundary,this.endBoundary=this.boundary+"--"}async add(e,t){let r=this.boundary+`\r
`;if(typeof t=="string"){r+='Content-Disposition: form-data; name="'+e+`"\r
\r
`,r+=t+`\r
`;for(let s=0;s<r.length;s++)this.body.push(r.charCodeAt(s))}else if(t instanceof File){r+='Content-Disposition: form-data; name="'+e+'"; filename="'+encodeURIComponent(t.name)+`"\r
`,r+="Content-Type: "+t.type+`\r
\r
`;for(let a=0;a<r.length;a++)this.body.push(r.charCodeAt(a));await ct(t).then(a=>{let n=new Uint8Array(a);this.body=this.body.concat(Array.prototype.slice.call(n))});let s=`\r
`;for(let a=0;a<s.length;a++)this.body.push(s.charCodeAt(a))}}getContentType(){return"multipart/form-data; boundary="+this.randomBoundary}getBody(){let e=[];for(let t=0;t<this.endBoundary.length;t++)e.push(this.endBoundary.charCodeAt(t));return this.body=this.body.concat(e),new Uint8Array(this.body).buffer}};var be=class extends A{constructor(e){super();this.parms=e}async upload(e){let t=new v;await t.add("uid",this.parms.required.uid),await t.add("token",this.parms.required.token),await t.add("file",e);let r={url:"https://www.imgurl.org/api/v2/upload",method:"POST",headers:{"Content-Type":_},body:t.getBody()};return await new Promise((s,a)=>{(0,bt.request)(r).then(n=>{let i=`![ImgURL](${JSON.parse(n).data.url})`;s(i)}).catch(n=>{a(n)})})}};var yt=P(require("obsidian"));var ye=class extends A{constructor(e){super();this.parms=e}async upload(e){let t=new v;await t.add("upload_preset",this.parms.required.present),await t.add("folder",this.parms.folder),await t.add("file",e);let r={url:`https://api.cloudinary.com/v1_1/${this.parms.required.name}/auto/upload`,method:"POST",headers:{"Content-Type":_},body:t.getBody()};return await new Promise((s,a)=>{(0,yt.request)(r).then(n=>{let i=`![Cloudinary](${JSON.parse(n).secure_url})`;s(i)}).catch(n=>{a(n)})})}};var wt=P(require("obsidian"));var we=class extends A{constructor(e){super();this.parms=e}async upload(e){let t=new v;await t.add("format","json"),await t.add("smfile",e);let r={url:"https://sm.ms/api/v2/upload",method:"POST",headers:{"Content-Type":_,Authorization:this.parms.required.token},body:t.getBody()};return await new Promise((s,a)=>{(0,wt.request)(r).then(n=>{let x=JSON.parse(n),i="";try{i=x.data.url}catch(S){i=x.images}let g=`![SMMS](${i})`;s(g)}).catch(n=>{a(n)})})}};var Ft=P(require("obsidian"));var Fe=class extends A{constructor(e){super();this.parms=e}async upload(e){let t=new v;await t.add("key",this.parms.required.key),await t.add("image",e);let r={url:"https://api.imgbb.com/1/upload",method:"POST",headers:{"Content-Type":_},body:t.getBody()};return await new Promise((s,a)=>{(0,Ft.request)(r).then(n=>{let g=`![imgbb](${JSON.parse(n).data.url})`;s(g)}).catch(n=>{a(n)})})}};var St=P(require("obsidian"));var Se=class extends A{constructor(e){super();this.parms=e}async upload(e){let t=new v;await t.add("image",e);let r;if(this.parms.anonymous){let s="Client-ID ";this.parms.clientid!==""?s+=this.parms.clientid:s+=V,r={url:"https://api.imgur.com/3/upload",method:"POST",headers:{"Content-Type":_,Authorization:s},body:t.getBody()}}else{let s=localStorage.getItem($);if(s!==null)r={url:"https://api.imgur.com/3/image",method:"POST",headers:{"Content-Type":_,Authorization:`Bearer ${s}`},body:t.getBody()};else return u("no sign in")}return await new Promise((s,a)=>{(0,St.request)(r).then(n=>{let x=JSON.parse(n),i=x.data.deletehash,g=x.data.link,S;this.parms.anonymous?S=`![${i}](${g})`:S=`![Imgur](${g})`,s(S)}).catch(n=>{a(n)})})}};var Et=P(require("obsidian"));var Ee=class extends A{constructor(e){super();this.parms=e}async upload(e){let t=new v;await t.add("reqtype","fileupload"),await t.add("userhash",this.parms.required.userhash),await t.add("fileToUpload",e);let r={url:"https://catbox.moe/user/api.php",method:"POST",headers:{"Content-Type":_},body:t.getBody()};return await new Promise((s,a)=>{(0,Et.request)(r).then(n=>{let x=`![Catbox](${n})`;s(x)}).catch(n=>{a(n)})})}};var Pt=P(require("obsidian"));var Pe=class extends A{constructor(e){super();this.parms=e}formatUrl(e){return!e.startsWith("https://")&&!e.startsWith("http://")&&(e="https://"+e),e.endsWith("/")&&(e=e.slice(0,-1)),e}async upload(e){let t=this.formatUrl(this.parms.required.domain),r=new v;await r.add("source",e),await r.add("key",this.parms.required.token);let s={url:t,method:"POST",headers:{"X-API-Key":this.parms.required.token,"Content-Type":_},body:r.getBody()};return await new Promise((a,n)=>{(0,Pt.request)(s).then(x=>{let i=JSON.parse(x),g="";g=i.image.url;let S=`![Chevereto](${g})`;a(S)}).catch(x=>{n(x)})})}};var B=P(require("obsidian"));var At=P(Tt()),Te=class extends A{constructor(e){super();this.parms=e}async upload(e){let t=await this.getToken();await this.determine(e)!=="success"&&await this.mkdirFile(e),await this.putFile(e),await this.refreshDir(e);let s=e.name;e.name==="image.png"&&(s=await this.renameFile(e));let a=await this.getFileExtension(e),n={url:`${this.parms.required.domain}/api/fs/get`,method:"POST",headers:{Authorization:t,"Content-Type":"application/json"},body:JSON.stringify({path:`/${this.parms.required.uploadPath}/${a}/${s}`})};return await new Promise((x,i)=>{(0,B.request)(n).then(async g=>{let S=JSON.parse(g),H=`![${s}](${S.data.raw_url})`;x(H)}).catch(g=>{i(g)})})}async getToken(){let e={url:`${this.parms.required.domain}/api/auth/login/hash`,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.parms.required.username,password:(0,At.sha256)(this.parms.required.password+"-https://github.com/alist-org/alist")})};return await new Promise((t,r)=>{(0,B.request)(e).then(s=>{let a=JSON.parse(s);t(a.data.token)}).catch(s=>{r(s)})})}async getFileExtension(e){let r=e.name.match(/\.([^.]+)$/);return r!=null?r[1]:""}async determine(e){let t=await this.getFileExtension(e),r={url:`${this.parms.required.domain}/api/fs/get`,method:"POST",headers:{Authorization:await this.getToken(),"Content-Type":"application/json"},body:JSON.stringify({path:`/${this.parms.required.uploadPath}/${t}`})};return await new Promise((s,a)=>{(0,B.request)(r).then(n=>{let x=JSON.parse(n);s(x.message)}).catch(n=>{a(n)})})}async mkdirFile(e){let t=await this.getFileExtension(e),r={url:`${this.parms.required.domain}/api/fs/mkdir`,method:"POST",headers:{Authorization:await this.getToken(),"Content-Type":"application/json"},body:JSON.stringify({path:`/${this.parms.required.uploadPath}/${t}`})};await(0,B.request)(r)}async putFile(e){let t=await this.getFileExtension(e),r=new v;await r.add("file",e);let s={url:`${this.parms.required.domain}/api/fs/form`,method:"PUT",headers:{Authorization:await this.getToken(),"Content-Type":_,"File-Path":encodeURIComponent(`/${this.parms.required.uploadPath}/${t}/${e.name}`),"As-Task":"true"},body:r.getBody()};await(0,B.request)(s)}async refreshDir(e){let t=await this.getFileExtension(e),r={url:`${this.parms.required.domain}/api/fs/list`,method:"POST",headers:{Authorization:await this.getToken(),"Content-Type":"application/json"},body:JSON.stringify({path:`/${this.parms.required.uploadPath}/${t}`,page:1,password:"",per_page:0,refresh:!0})};await(0,B.request)(r)}async renameFile(e){let t=await this.getFileExtension(e),r=new Date,s=x=>x.toString().padStart(2,"0"),a=`${r.getFullYear()}${s(r.getMonth()+1)}${s(r.getDate())}-${s(r.getHours())}:${s(r.getMinutes())}:${s(r.getSeconds())}.${t}`,n={url:`${this.parms.required.domain}/api/fs/rename`,method:"POST",headers:{Authorization:await this.getToken(),"Content-Type":"application/json"},body:JSON.stringify({name:a,path:`/${this.parms.required.uploadPath}/${t}/${e.name}`})};return await(0,B.request)(n),a}};var Ae=class extends J.Plugin{async onload(){console.log("loading  Emo uploader"),await this.loadSettings(),this.setupPasteHandler(),this.addSettingTab(new ge(this.app,this))}onunload(){console.log("unloading Emo uploader")}async loadSettings(){this.config=Object.assign({},pt,await this.loadData())}async saveSettings(){await this.saveData(this.config)}setupPasteHandler(){this.registerEvent(this.app.workspace.on("editor-drop",async(e,t)=>{let{files:r}=e.dataTransfer;this.startUpload(r,e,t)})),this.registerEvent(this.app.workspace.on("editor-paste",async(e,t)=>{let{files:r}=e.clipboardData;this.startUpload(r,e,t)}))}startUpload(e,t,r){let s;if(e.length>0)if(s={[w.Github]:()=>new xe(this.config.github_parms),[w.ImgURL]:()=>new be(this.config.imgurl_parms),[w.Cloudinary]:()=>new ye(this.config.cloudinary_parms),[w.Smms]:()=>new we(this.config.smms_parms),[w.Imgbb]:()=>new Fe(this.config.imgbb_parms),[w.Imgur]:()=>new Se(this.config.imgur_parms),[w.Catbox]:()=>new Ee(this.config.catbox_parms),[w.Chevereto]:()=>new Pe(this.config.chevereto_parms),[w.Alist]:()=>new Te(this.config.alist_parms)}[this.config.choice](),s.isValid()){t.preventDefault();for(let n of e){let i=`![uploading...](${(Math.random()*10086).toString(36).slice(-6)})
`;r.replaceSelection(i),s.upload(n).then(g=>{let S=n.type.startsWith("image")?0:1;this.replaceText(r,i,g.slice(S))}).catch(g=>{this.replaceText(r,i,`[${this.config.choice} upload error]()`),console.log(new J.Notice(this.config.choice+u("upload error"),2e3)),console.log(g)})}}else console.log(new J.Notice(u("parms error"),2e3)),console.log(s)}replaceText(e,t,r){t=t.trim();let s=[];for(let a=0;a<e.lineCount();a++)s.push(e.getLine(a));for(let a=0;a<s.length;a++){let n=s[a].indexOf(t);if(n!==-1){let x={line:a,ch:n},i={line:a,ch:n+t.length};e.replaceRange(r,x,i);break}}}};0&&(module.exports={});
/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.10.1
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2023
 * @license MIT
 */
