### Burp Suiteを活用した実践例

#### シナリオ1: 企業XのWebサーバーのOSINT

1. **ターゲットサイトのスキャン**:
    - **手順**: Burp SuiteのSpider機能を使用して、企業Xのメインサイト（example.com）をスキャンします。
    - **目的**: 使用されているCMSを特定します。
    - **実施方法**: `Target > Request > Connection`の値が`wp`であることを確認し、CMSがWordPressであることを特定します。
    - **コマンド例**: 
      ```shell
      burpsuite spider http://example.com
      ```

2. **サブドメイン列挙**:
    - **手順**: Sublist3rやBurp Suiteの機能を使用して、企業Xのサブドメインを列挙します。
    - **目的**: 潜在的な攻撃ポイントとなるサブドメインを特定します。
    - **実施方法**: admin.example.comという管理用サブドメインを発見します。
    - **コマンド例**:
      ```shell
      sublist3r -d example.com
      ```

3. **ディレクトリ列挙**:
    - **手順**: admin.example.comに対して、ディレクトリ列挙を実行します。
    - **目的**: 隠しディレクトリや重要なファイルの存在を確認します。
    - **実施方法**: /backupディレクトリを発見します。
    - **コマンド例**:
      ```shell
      dirb http://admin.example.com
      ```

4. **バックアップファイルの確認**:
    - **手順**: /backupディレクトリの中身を確認します。
    - **目的**: 過去のデータベースバックアップなど、機密データが存在するかを確認します。
    - **実施方法**: /backupディレクトリにデータベースバックアップファイルが存在することを確認します。
    - **コマンド例**:
      ```shell
      curl http://admin.example.com/backup/
      ```

5. **ログインページへのブルートフォース**:
    - **手順**: admin.example.comのログインページに対してブルートフォース攻撃を実施します。
    - **目的**: 弱い認証情報を見つけて、管理者権限を取得します。
    - **実施方法**: admin:password123という弱い認証情報を特定します。
    - **コマンド例**:
      ```shell
      hydra -l admin -P wordlist.txt admin.example.com http-post-form "/login:username=^USER^&password=^PASS^:F=incorrect"
      ```

#### シナリオ2: 小売業Yのオンラインストアの脆弱性調査

1. **ターゲットサイトのパッシブスキャン**:
    - **手順**: Burp SuiteのProxy機能を使用して、小売業Yのオンラインストア（shop.example.com）のトラフィックをパッシブスキャンします。
    - **目的**: サイトの基本的な構造や技術スタックを把握します。
    - **実施方法**: HTTPヘッダーやHTMLメタタグから技術情報を収集します。

2. **インプットフィールドの検証**:
    - **手順**: Burp SuiteのIntruder機能を使用して、商品検索フィールドに対してSQLインジェクション攻撃を実施します。
    - **目的**: インプットフィールドの脆弱性を特定します。
    - **実施方法**: 脆弱なパラメータに対して特定のペイロードを送信し、SQLエラーメッセージの有無を確認します。
    - **ペイロード例**:
      ```shell
      ' OR '1'='1
      ```

3. **セッション管理のテスト**:
    - **手順**: Burp SuiteのRepeater機能を使用して、複数のリクエストを送信し、セッション管理の脆弱性をテストします。
    - **目的**: セッション固定攻撃やセッションハイジャックのリスクを確認します。
    - **実施方法**: 同一セッションIDを使用して、複数のリクエストを送信し、応答を比較します。

4. **クロスサイトスクリプティング（XSS）テスト**:
    - **手順**: Burp SuiteのIntruder機能を使用して、フォームフィールドやURLパラメータに対してXSS攻撃を実施します。
    - **目的**: XSS脆弱性を特定し、攻撃者が任意のJavaScriptを実行できるか確認します。
    - **ペイロード例**:
      ```html
      <script>alert('XSS');</script>
      ```

5. **レポートの生成**:
    - **手順**: Burp Suiteのレポート機能を使用して、発見した脆弱性を報告書にまとめます。
    - **目的**: 発見された脆弱性の詳細、影響範囲、推奨対策を含む包括的なレポートを作成します。
    - **実施方法**: 各脆弱性について、発見の経緯と修正方法を詳細に記述します。

#### シナリオ3: 官公庁Zのウェブポータルのセキュリティ評価

1. **サーバー情報の収集**:
    - **手順**: Nmapを使用して、官公庁Zのウェブポータル（portal.gov.example）のサーバー情報を収集します。
    - **目的**: 開いているポートやサービスのバージョン情報を特定します。
    - **コマンド例**:
      ```shell
      nmap -sV -A portal.gov.example
      ```

2. **ディレクトリのブルートフォース**:
    - **手順**: Burp SuiteのIntruder機能を使用して、ディレクトリブルートフォース攻撃を実施します。
    - **目的**: 隠されたディレクトリやファイルを特定します。
    - **ペイロード例**:
      ```shell
      /admin
      /config
      /backup
      ```

3. **CSRFテスト**:
    - **手順**: Burp SuiteのCSRF機能を使用して、CSRF（Cross-Site Request Forgery）脆弱性をテストします。
    - **目的**: セッション管理の脆弱性を特定し、CSRF攻撃のリスクを確認します。
    - **実施方法**: 特定のリクエストを他のユーザーのセッションで実行可能か確認します。

4. **エラーメッセージの解析**:
    - **手順**: Burp SuiteのProxy機能を使用して、エラーメッセージを解析します。
    - **目的**: エラーメッセージから内部構造や技術情報を収集します。
    - **実施方法**: エラーメッセージをトリガーするリクエストを送信し、返されるメッセージを解析します。

5. **レポートの生成**:
    - **手順**: Burp Suiteのレポート機能を使用して、発見した脆弱性を報告書にまとめます。
    - **目的**: 発見された脆弱性の詳細、影響範囲、推奨対策を含む包括的なレポートを作成します。
    - **実施方法**: 各脆弱性について、発見の経緯と修正方法を詳細に記述します。

