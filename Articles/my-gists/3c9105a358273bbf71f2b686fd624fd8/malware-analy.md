マルウェア分析を実行し、PDF、EXE、XLSX などのコンパイル済みファイルから法医学的に意味のあるデータを抽出するには、さまざまなツールとテクニックを利用できます。ここで、あなたが言及したツールを使用した構造化されたアプローチを示します。

### マルウェア分析のステップバイステップ ガイド

1. **予備分析:**
- **静的分析:** 静的分析から始めて、ファイルを実行せずに調べます。これには、ファイルのメタデータ、構造、および埋め込まれたリソースの調査が含まれます。
- **PDF:** `pdfid`、`pdf-parser`、`peepdf` などのツールを使用して、PDF 構造を分析し、埋め込まれたスクリプトや異常なオブジェクトを確認します。
- **EXE:** `PEiD`、`ExEinfo PE`、`CFF Explorer` などのツールを使用して、使用されているコンパイラとパッカーを識別します。`PE Explorer` または `PE Studio` も PE ヘッダーの分析に役立ちます。
- **XLSX:** `OLETools` などのツールを使用して、埋め込まれたマクロや悪意のある VBA コードを確認します。

2. **動的分析:**
- 制御された環境 (サンドボックス) でファイルを実行し、その動作を観察します。Cuckoo Sandbox や Any.Run などのツールが役立ちます。
- **デバッガー:** `Ollydbg` を使用して、EXE ファイルの実行をステップ実行します。これは、実行可能ファイルの動作を理解するのに役立ちます。
- **サブシステム コール:** `Process Monitor` や `Process Explorer` などのツールを使用して、システム コール、ファイル操作、およびネットワーク アクティビティを監視します。

3. **高度な分析:**
- **EXE 分析:**
- **デバッガーの使用法:** `Ollydbg` と `xAnalyzer` や `OllyAdvanced` などのプラグインを使用して、実行可能ファイルの動作を分析します。
- **アンチデバッグ手法:** `IsDebuggerPresent` などの手法をチェックし、`ScyllaHide` などのツールを使用してそれらを回避します。
- **逆アセンブラ:** より詳細な静的分析には、IDA Pro や Ghidra などのツールを使用します。
- **動的分析:** サンドボックスで EXE を実行し、`Process Monitor` を使用して API 呼び出しとシステムの変更をキャプチャします。
- **PDF 分析:**
- **JavaScript 分析:** `pdf-parser` を使用して埋め込まれた JavaScript を探します。
- **オブジェクト ストリーム:** 埋め込まれたオブジェクトとストリームを調べて、非表示のペイロードを探します。
- **XLSX 分析:**
- **マクロ分析:** `OLETools` を使用して VBA マクロを抽出および分析します。
- **動的実行:** `ProcMon` などのツールを使用して仮想マシンで XLSX ファイルを開き、その動作を観察します。

4. **フォレンジック データ抽出:**
- **メモリ分析:** マルウェアが実行された場合は、Volatility などのツールを使用してメモリ ダンプを分析します。
- **ファイル カービング:** `Foremost` や `Scalpel` などのツールを使用して、削除されたファイルや非表示のファイルを復元します。
- **ネットワーク トラフィック分析:** Wireshark を使用してネットワーク トラフィックをキャプチャおよび分析し、C2 サーバーとの通信を特定します。

### 特定のツールとテクニック:

1. **Ollydbg:**
- Ollydbg をプロセスにアタッチし、ブレークポイントを使用して実行フローを分析します。
- `ScyllaHide` などのプラグインを使用して、アンチデバッグ テクニックを回避します。

2. **xAnalyzer:**
- Ollydbg で xAnalyzer を使用して、より読みやすい出力と API 呼び出し情報で逆アセンブリを強化します。

3. **ScyllaHide:**
- 一般的なアンチデバッグ手法を回避するために、ScyllaHide 構成を適用します。

4. **Volatility:**
- Volatility を使用してメモリ分析を行い、メモリ ダンプからアーティファクトを抽出します。

5. **Wireshark:**
- ネットワーク トラフィックを監視および分析して、データ流出の試みや C2 通信を検出します。

### コマンドとツールの使用例:

- **PDF 分析:**
```sh
pdfid malware.pdf
pdf-parser -s malware.pdf
```

- **EXE 分析:**
- Ollydbg で EXE をロードし、重要な関数にブレークポイントを設定します。
- アンチデバッグを回避するために、ScyllaHide を使用します。
```sh
strings malware.exe
peid malware.exe
```

- **XLSX 分析:**
```sh
olevba malware.xlsx
```

### HTB 記述からの実用的な例:
1. **「Bolt」HTB での Ollydbg の使用:**
- Ollydbg を使用してバイナリを分析し、そのフローを理解してアンチデバッグ手法を検出します【16†ソース】。

2. **「Luke」HTB でのメモリ分析:**
- Volatility を使用してプロセス メモリを抽出し、挿入されたコードまたはマルウェアの動作を分析します【15†ソース】。

3. **「Horizo​​ntall」HTB でのネットワーク トラフィック:**
- Wireshark を使用してネットワーク トラフィックをキャプチャし、流出の試みを特定します【17†ソース】。

これらの手順に従い、前述のツールを利用することで、徹底的なマルウェア分析を実行し、さまざまなファイル タイプからフォレンジック的に意味のあるデータを抽出できます。


- [How vx-underground is building a hacker\\'s dream library](https://therecord.media/how-vx-underground-is-building-a-hackers-dream-library)